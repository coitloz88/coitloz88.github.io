<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Pytorch tutorials 04 신경망 모델 구성하기" /><meta property="og:locale" content="en" /><meta name="description" content="신경망은 데이터 연산을 수행하는 layer / module로 구성되어있다. torch.nn 네임스페이스는 신경망을 구성하는데 필요한 모든 구성 요소를 제공한다." /><meta property="og:description" content="신경망은 데이터 연산을 수행하는 layer / module로 구성되어있다. torch.nn 네임스페이스는 신경망을 구성하는데 필요한 모든 구성 요소를 제공한다." /><link rel="canonical" href="https://coitloz88.github.io/posts/pytorch-tutorial-4/" /><meta property="og:url" content="https://coitloz88.github.io/posts/pytorch-tutorial-4/" /><meta property="og:site_name" content="Devlog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-12T09:40:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Pytorch tutorials 04 신경망 모델 구성하기" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-14T00:38:04+09:00","datePublished":"2022-05-12T09:40:00+09:00","description":"신경망은 데이터 연산을 수행하는 layer / module로 구성되어있다. torch.nn 네임스페이스는 신경망을 구성하는데 필요한 모든 구성 요소를 제공한다.","headline":"Pytorch tutorials 04 신경망 모델 구성하기","mainEntityOfPage":{"@type":"WebPage","@id":"https://coitloz88.github.io/posts/pytorch-tutorial-4/"},"url":"https://coitloz88.github.io/posts/pytorch-tutorial-4/"}</script><title>Pytorch tutorials 04 | 신경망 모델 구성하기 | Devlog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Devlog"><meta name="application-name" content="Devlog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/profileIMG.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Devlog</a></div><div class="site-subtitle font-italic">CS Study Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/coitloz88" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.acmicpc.net/user/coitloz32" aria-label="baekjoon" target="_blank" rel="noopener"> <i class="fas fa-code"></i> </a> <a href="https://coitloz88.notion.site/Profile-Hyemin-Lee-9e2a275d08d04ae48685d02ec1ccc651" aria-label="notion" target="_blank" rel="noopener"> <i class="fas fa-book"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['cotloz88','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Pytorch tutorials 04 | 신경망 모델 구성하기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Pytorch tutorials 04 | 신경망 모델 구성하기</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/coitloz88">coitloz88</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1652316000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-12 </em> </span> <span> Updated <em class="timeago" data-ts="1652456284" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2022-05-14 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="905 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><p>신경망은 데이터 연산을 수행하는 layer / module로 구성되어있다.<br /> <a href="https://pytorch.org/docs/stable/nn.html">torch.nn</a> 네임스페이스는 신경망을 구성하는데 필요한 모든 구성 요소를 제공한다.</p><p><br /></p><p>FashionMNIST 데이터셋의 이미지를 분류하는 신경망을 구성해보자.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>
<span class="kn">from</span> <span class="nn">torchvision</span> <span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">transforms</span>
</pre></table></code></div></div><p><br /></p><hr /><p><br /></p><h1 id="학습을-위한-장치-얻기">학습을 위한 장치 얻기</h1><p>가능한 경우 GPU와 같은 하드웨어 가속기에서 모델을 학습하자.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">device</span> <span class="o">=</span> <span class="s">"cuda"</span> <span class="ow">is</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s">"cpu"</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Using </span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s"> device"</span><span class="p">)</span>
</pre></table></code></div></div><h1 id="클래스-정의하기">클래스 정의하기</h1><p>신경망 모델을 <code class="language-plaintext highlighter-rouge">nn.Module</code>의 하위클래스로 정의하고, <code class="language-plaintext highlighter-rouge">__init__</code>에서 신경망 계층을 초기화한다. <code class="language-plaintext highlighter-rouge">nn.Module</code>을 상송받은 모든 클래스는 <code class="language-plaintext highlighter-rouge">forward</code> 메소드에 입력 데이터에 대한 연산들을 구현한다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">NeuralNetwork</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NeuralNetwork</span><span class="p">,</span> <span class="bp">self</span><span class="p">).</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">flatten</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Flatten</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">linear_relu_stack</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Sequential</span><span class="p">(</span>
            <span class="n">nn</span><span class="p">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span>
            <span class="n">nn</span><span class="p">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="p">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">),</span>
            <span class="n">nn</span><span class="p">.</span><span class="n">ReLU</span><span class="p">(),</span>
            <span class="n">nn</span><span class="p">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">linear_relu_stack</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">logits</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">NeuralNetwork</code>의 instance를 생성하고 이를 <code class="language-plaintext highlighter-rouge">device</code>로 이동한 뒤, structure을 출력한다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">model</span> <span class="o">=</span> <span class="n">NeuralNetwork</span><span class="p">().</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></table></code></div></div><p>모델을 사용하기 위해 입력 데이터를 전달한다. 이는 일부 백그라운드 연산과 함께 모델의 <code class="language-plaintext highlighter-rouge">forward</code>를 실행한다.</p><blockquote class="prompt-tip"><div><p><code class="language-plaintext highlighter-rouge">model.forward()</code>를 직접 호출하지 말자.</p></div></blockquote><p>모델에 입력을 호출하면 각 class에 대한 raw 예측 값이 있는 10차원 텐서가 반환된다. raw 예측 값을 <code class="language-plaintext highlighter-rouge">nn.Softmax</code> 모듈의 인스턴스에 통과시켜 예측 확률을 얻을 수 있다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>
<span class="n">logits</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">pred_probab</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Softmax</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)(</span><span class="n">logits</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">pred_probab</span><span class="p">.</span><span class="n">argmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Predicted class: </span><span class="si">{</span><span class="n">y_pred</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</pre></table></code></div></div><p><br /></p><hr /><p><br /></p><h1 id="layer">Layer</h1><p>FashionMNIST 모델의 layer을 28*28 크기의 이미지 3개로 구성된 미니배치 예제를 통해 살펴보자.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">input_image</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="nnflatten"><span class="mr-2">nn.Flatten</span><a href="#nnflatten" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">nn.Flatten</code> layer를 초기화하여 각 28*28의 2D 이미지를 784 픽셀을 갖는 연속된 배열로 반환한다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">flatten</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Flatten</span><span class="p">()</span>
<span class="n">flat_image</span> <span class="o">=</span> <span class="n">flatten</span><span class="p">(</span><span class="n">input_image</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="nnlinear"><span class="mr-2">nn.Linear</span><a href="#nnlinear" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>선형 계층은 저장된 weight과 bias를 사용하여 입력에 linear transformation을 적용하는 모듈이다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">layer1</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span> <span class="o">=</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="n">out_features</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">hidden1</span> <span class="o">=</span> <span class="n">layer1</span><span class="p">(</span><span class="n">flat_image</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="nnrelu"><span class="mr-2">nn.ReLU</span><a href="#nnrelu" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>non-linear activation은 모델의 입력과 출력 사이에 복잡한 mapping을 만든다. non-linear activation은 선형 변환 후 적용되어 nonlinearity를 도입하며, 신경망이 다양한 현상을 학습할 수 있도록 돕는다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">hidden1</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">ReLU</span><span class="p">()(</span><span class="n">hidden1</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="nnsequential"><span class="mr-2">nn.Sequential</span><a href="#nnsequential" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><code class="language-plaintext highlighter-rouge">nn.Sequential</code>은 순서를 갖는 모듈의 컨테이너로, 데이터는 정의된 순서로 모든 모듈들을 통해 전달된다. sequential container를 사용하여 일부 신경망을 빠르게 만들 수 있다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="n">seq_modules</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="n">flatten</span><span class="p">,</span>
    <span class="n">layer1</span><span class="p">,</span>
    <span class="n">nn</span><span class="p">.</span><span class="n">ReLU</span><span class="p">(),</span>
    <span class="n">nn</span><span class="p">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">input_image</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">)</span>
<span class="n">logits</span> <span class="o">=</span> <span class="n">seq_modules</span><span class="p">(</span><span class="n">input_image</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="nnsoftmax"><span class="mr-2">nn.Softmax</span><a href="#nnsoftmax" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>신경망의 마지막 선형 계층은 <code class="language-plaintext highlighter-rouge">nn.Softmax</code> 모듈에 전달될 ([-infty, infty] 범위의 raw value인) logits 를 반환한다. 이때, logits는 모델의 각 class에 대한 예측 확률을 나타내도록 [0, 1] 범위로 조정된다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">softmax</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="n">Softmax</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">pred_probab</span> <span class="o">=</span> <span class="n">softmax</span><span class="p">(</span><span class="n">logits</span><span class="p">)</span>
</pre></table></code></div></div><h1 id="모델-매개변수">모델 매개변수</h1><p>신경망 내부의 많은 계층은 parameterize된다. 즉, 학습 중에 최적화되는 weight, bias와 연관지어진다. <code class="language-plaintext highlighter-rouge">nn.Module</code>를 상속하면 모델 객체 내부의 모든 필드를 자동으로 추적할 수 있게 되며, 모델의 <code class="language-plaintext highlighter-rouge">parameters()</code> 및 <code class="language-plaintext highlighter-rouge">named_parameters()</code> 메소드로 모든 매개변수에 접근할 수 있다.</p><p><br /></p><hr /><p><br /></p><h1 id="references">References</h1><ul><li><a href="https://tutorials.pytorch.kr/beginner/basics/buildmodel_tutorial.html">https://tutorials.pytorch.kr/beginner/basics/buildmodel_tutorial.html</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ml/'>ML</a>, <a href='/categories/pytorch/'>pytorch</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ml/" class="post-tag no-text-decoration" >ML</a> <a href="/tags/pytorch/" class="post-tag no-text-decoration" >pytorch</a> <a href="/tags/tutorial/" class="post-tag no-text-decoration" >tutorial</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Pytorch tutorials 04 | 신경망 모델 구성하기 - Devlog&amp;url=https://coitloz88.github.io/posts/pytorch-tutorial-4/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Pytorch tutorials 04 | 신경망 모델 구성하기 - Devlog&amp;u=https://coitloz88.github.io/posts/pytorch-tutorial-4/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://coitloz88.github.io/posts/pytorch-tutorial-4/&amp;text=Pytorch tutorials 04 | 신경망 모델 구성하기 - Devlog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/backend-2/">웹 백엔드 1-2 Maven 및 기초 환경 세팅</a><li><a href="/posts/pytorch-tutorial-6/">Pytorch tutorials 06 | 모델 매개변수 최적화하기</a><li><a href="/posts/baekjoon11729/">백준 11729</a><li><a href="/posts/pytorch-tutorial-4/">Pytorch tutorials 04 | 신경망 모델 구성하기</a><li><a href="/posts/pytorch-tutorial-1/">Pytorch tutorials 01 | Tensor</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/ml/">ML</a> <a class="post-tag" href="/tags/pytorch/">pytorch</a> <a class="post-tag" href="/tags/backend/">backend</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/codelab/">codelab</a> <a class="post-tag" href="/tags/computer/">computer</a> <a class="post-tag" href="/tags/baekjoon/">baekjoon</a> <a class="post-tag" href="/tags/flask/">flask</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/pytorch-tutorial-5/"><div class="card-body"> <em class="timeago small" data-ts="1652454660" > 2022-05-14 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pytorch tutorials 05 | TORCH.AUTOGRAD를 사용한 자동 미분</h3><div class="text-muted small"><p> 신경망을 학습할 때 가장 자주 사용되는 알고리즘인 Back Propagation에서, 매개변수(weight과 bias)는 주어진 매개변수에 대한 Error function의 Gradient에 따라 조정된다. 이를 위해 Pytorch에 내장되어 있는 자동 미분 엔진 torch.autograd를 사용한다. Input x, Weight w, Bias b...</p></div></div></a></div><div class="card"> <a href="/posts/pytorch-tutorial-6/"><div class="card-body"> <em class="timeago small" data-ts="1652857200" > 2022-05-18 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pytorch tutorials 06 | 모델 매개변수 최적화하기</h3><div class="text-muted small"><p> 이때까지의 과정을 통해 모델과 데이터를 준비했다. 이제는 데이터에 매개변수를 최적화하여 모델을 학습하고, 검증(평가)하고, 테스트할 차례이다. 모델을 학습하는 과정은 다음과 같은 반복적인 과정(epoch)을 거친다. 모델은 출력을 추측한다. 추측과 실제 정답 사이의 오류(loss)를 계산한다. 매개변수에 대한 오류의 도함수를 수집하고,...</p></div></div></a></div><div class="card"> <a href="/posts/pytorch-tutorial-7/"><div class="card-body"> <em class="timeago small" data-ts="1653886200" > 2022-05-30 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pytorch tutorials 07 | 모델 저장하고 불러오기</h3><div class="text-muted small"><p> 마지막으로 모델의 예측을 저장, 로드 및 실행하여 모델의 state를 유지하는 방법에 관해 알아보려고 한다. 1 2 import torch import torchvision.models as models Saving and Loading Model Weights Pytorch의 모델은 학습한 매개변수를 state_dict라고 불리는 intern...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/pytorch-tutorial-3/" class="btn btn-outline-primary" prompt="Older"><p>Pytorch tutorials 03 | Transform</p></a> <a href="/posts/pytorch-tutorial-5/" class="btn btn-outline-primary" prompt="Newer"><p>Pytorch tutorials 05 | TORCH.AUTOGRAD를 사용한 자동 미분</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/coitloz88">coitloz88</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/tutorial/">tutorial</a> <a class="post-tag" href="/tags/android/">android</a> <a class="post-tag" href="/tags/ml/">ML</a> <a class="post-tag" href="/tags/pytorch/">pytorch</a> <a class="post-tag" href="/tags/backend/">backend</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/codelab/">codelab</a> <a class="post-tag" href="/tags/computer/">computer</a> <a class="post-tag" href="/tags/baekjoon/">baekjoon</a> <a class="post-tag" href="/tags/flask/">flask</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
